import{a as F,b as D,c as T,d as I,f as B,g as A,h as L,j,k as te,l as M}from"./chunk-SNHZX2Q6.js";import{A as K,B as Q,D as x,F as O,G as X,H as Y,I as n,J as o,K as y,L as k,M as d,N as g,O as a,P as V,R as N,V as E,ca as P,da as Z,ea as ee,g as $,h as z,j as U,k as W,l as b,m as H,p as S,q as C,s as w,u as c,v as h,x as J,z as q}from"./chunk-PGJVZ2AK.js";import"./chunk-LJ5XHLMQ.js";import{a as m,b as u,h as l}from"./chunk-FK42CRUA.js";var p=class r{constructor(t,e){this.supaBaseService=t;this.authService=e;this.supaBaseClient=t.supabaseClient}supaBaseClient;state=J({notes:[],loading:!1,error:!1});notesSignalComputed=E(()=>this.state().notes);loadingSignalComputed=E(()=>this.state().loading);errorSignalComputed=E(()=>this.state().error);getUserNotes(){return l(this,null,function*(){try{this.state.update(i=>u(m({},i),{loading:!0}));let{data:{session:t}}=yield this.authService.session(),{data:e}=yield this.supaBaseClient.from("notes").select().eq("user_id",t?.user.id).returns();e&&this.state.update(i=>u(m({},i),{notes:e}))}catch{this.state.update(e=>u(m({},e),{error:!0}))}finally{this.state.update(t=>u(m({},t),{loading:!1}))}})}getAllNotes(){return l(this,null,function*(){try{this.state.update(i=>u(m({},i),{loading:!0}));let{data:{session:t}}=yield this.authService.session(),{data:e}=yield this.supaBaseClient.from("notes").select().returns();e&&this.state.update(i=>u(m({},i),{notes:e}))}catch{this.state.update(e=>u(m({},e),{error:!0}))}finally{this.state.update(t=>u(m({},t),{loading:!1}))}})}insertNote(t){return l(this,null,function*(){let{data:{session:e}}=yield this.authService.session();try{let i=yield this.supaBaseClient.from("notes").insert({user_id:e?.user.id,title:t.title,description:t.description,created_at:new Date});return this.responseTemplate(i)}catch(i){return console.error("Unexpected error:",i),{success:!1,error:i}}})}updateNote(t,e){return l(this,null,function*(){try{let i=yield this.supaBaseClient.from("notes").update({title:t.title,description:t.description}).eq("id",e);return this.responseTemplate(i)}catch(i){return console.error("Unexpected error:",i),{success:!1,error:i}}})}responseTemplate(t){return l(this,null,function*(){return t.error?{success:!1,error:t.error}:(yield this.getUserNotes(),{success:!0,data:t.data})})}deleteNote(t){return l(this,null,function*(){try{let e=yield this.supaBaseClient.from("notes").delete().eq("id",t);return this.responseTemplate(e)}catch(e){return console.error("Unexpected error:",e),{success:!1,error:e}}})}static \u0275fac=function(e){return new(e||r)(U(Z),U(ee))};static \u0275prov=$({token:r,factory:r.\u0275fac,providedIn:"root"})};var _=class r{constructor(t,e){this.noteService=t;this.formBuilder=e;this.form=this.formBuilder.group({title:this.formBuilder.control(null,D.required),description:this.formBuilder.control(null)})}form;addVerificacion=new w;send(){return l(this,null,function*(){if(this.form.invalid)return;(yield this.noteService.insertNote({title:this.form.value.title??"",description:this.form.value.description})).success?this.addVerificacion.emit(!0):this.addVerificacion.emit(!1)})}static \u0275fac=function(e){return new(e||r)(h(p),h(j))};static \u0275cmp=b({type:r,selectors:[["app-add-note"]],outputs:{addVerificacion:"addVerificacion"},standalone:!0,features:[N],decls:12,vars:1,consts:[[1,"pt-36","w-3/4","mx-auto","relative","overflow-x-auto","sm:rounded-lg"],[1,"max-w-sm","mx-auto",3,"ngSubmit","formGroup"],["for","title",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","text","id","title","formControlName","title",1,"block","w-full","p-2","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","text-xs","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],[1,"mb-5"],["for","large-input",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","text","id","large-input","formControlName","description",1,"block","w-full","p-4","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","text-base","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["type","submit",1,"w-full","text-white","bg-green-500","hover:bg-primary-700","focus:ring-4","focus:outline-none","focus:ring-primary-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","dark:bg-primary-600","dark:hover:bg-primary-700","dark:focus:ring-primary-800"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"form",1),d("ngSubmit",function(){return i.send()}),n(2,"div")(3,"label",2),a(4,"Titulo"),o(),y(5,"input",3),o(),n(6,"div",4)(7,"label",5),a(8,"Descripcion"),o(),y(9,"input",6),o(),n(10,"button",7),a(11," Enviar Nota "),o()()()),e&2&&(c(),x("formGroup",i.form))},dependencies:[M,B,F,T,I,A,L]})};var v=class r{constructor(t,e){this.noteService=t;this.formBuilder=e;this.form=this.formBuilder.group({title:this.formBuilder.control(null,D.required),description:this.formBuilder.control(null)})}form;notaSeleccionada;editVerificacion=new w;deleteNote;send(){return l(this,null,function*(){if(this.form.invalid)return;let t=yield this.noteService.updateNote({title:this.form.value.title??"",description:this.form.value.description},this.notaSeleccionada.id);console.log(t),t.success?this.editVerificacion.emit(!0):this.editVerificacion.emit(!1)})}ngOnInit(){this.form.setValue({title:this.notaSeleccionada.title,description:this.notaSeleccionada.description})}cerrar(){console.log("entre"),this.form.setValue({title:"",description:""}),this.editVerificacion.emit(!1)}borrar(){return l(this,null,function*(){if(this.form.invalid)return;(yield this.noteService.deleteNote(this.notaSeleccionada.id)).success?this.editVerificacion.emit(!0):this.editVerificacion.emit(!1)})}static \u0275fac=function(e){return new(e||r)(h(p),h(j))};static \u0275cmp=b({type:r,selectors:[["app-edit-note"]],inputs:{notaSeleccionada:"notaSeleccionada",deleteNote:"deleteNote"},outputs:{editVerificacion:"editVerificacion"},standalone:!0,features:[N],decls:16,vars:1,consts:[[1,"pt-36","w-3/4","mx-auto","relative","overflow-x-auto","sm:rounded-lg"],[1,"max-w-sm","mx-auto",3,"ngSubmit","formGroup"],["for","title",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","text","id","title","formControlName","title",1,"block","w-full","p-2","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","text-xs","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],[1,"mb-5"],["for","large-input",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","text","id","large-input","formControlName","description",1,"block","w-full","p-4","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","text-base","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["type","submit",1,"w-full","text-white","bg-green-500","hover:bg-primary-700","focus:ring-4","focus:outline-none","focus:ring-primary-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","dark:bg-primary-600","dark:hover:bg-primary-700","dark:focus:ring-primary-800"],["type","button",1,"w-full","text-white","bg-red-800","mt-8","hover:bg-primary-700","focus:ring-4","focus:outline-none","focus:ring-primary-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","dark:bg-primary-600","dark:hover:bg-primary-700","dark:focus:ring-primary-800",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"form",1),d("ngSubmit",function(){return i.send()}),n(2,"div")(3,"label",2),a(4,"Titulo"),o(),y(5,"input",3),o(),n(6,"div",4)(7,"label",5),a(8,"Descripcion"),o(),y(9,"input",6),o(),n(10,"button",7),a(11," Actualizar Nota "),o(),n(12,"button",8),d("click",function(){return i.borrar()}),a(13," Borrar Nota "),o(),n(14,"button",8),d("click",function(){return i.cerrar()}),a(15," Cerrar "),o()()()),e&2&&(c(),x("formGroup",i.form))},dependencies:[te,B,F,T,I,M,A,L]})};var ae=(r,t)=>t.id;function se(r,t){if(r&1){let e=k();n(0,"app-add-note",7),d("addVerificacion",function(s){S(e);let f=g();return C(f.recibirDato(s))}),o()}}function le(r,t){if(r&1){let e=k();n(0,"app-edit-note",8),d("editVerificacion",function(s){S(e);let f=g();return C(f.recibirDato(s))}),o()}if(r&2){let e=g();x("notaSeleccionada",e.noteSelected)("deleteNote",e.deleteNoteValidation)}}function de(r,t){if(r&1){let e=k();n(0,"tr",9)(1,"th",10),a(2),o(),n(3,"td",11),a(4),o(),n(5,"td",11),a(6),o(),n(7,"td",12)(8,"a",13),d("click",function(){let s=S(e).$implicit,f=g(2);return C(f.editNote(s))}),a(9,"Edit"),o(),n(10,"a",14),d("click",function(){let s=S(e).$implicit,f=g(2);return C(f.deleteNote(s))}),a(11,"Remove"),o()()()}if(r&2){let e=t.$implicit;c(2),V(" ",e.id," "),c(2),V(" ",e.title," "),c(2),V(" ",e.description?e.description:"No hay descripcion"," ")}}function ce(r,t){r&1&&(n(0,"tr",9)(1,"th",15),a(2," No hay notas para este usuario "),o()())}function me(r,t){if(r&1&&X(0,de,12,3,"tr",9,ae,!1,ce,3,0,"tr",9),r&2){let e=g();Y(e.ordernarIds())}}function ue(r,t){r&1&&(n(0,"p"),a(1,"Estoy cargando panita"),o())}var R=class r{noteService=W(p);noteSelected;addNoteVerification=!1;editNoteVerification=!1;deleteNoteValidation;ngAfterViewInit(){this.noteService.getUserNotes()}editNote(t){this.noteSelected=t,this.editNoteVerification=!0}deleteNote(t){this.noteSelected=t,this.editNoteVerification=!0,this.deleteNoteValidation=!0}addNote(){this.addNoteVerification=!0}recibirDato(t){t&&alert("Nota dada de alta"),this.addNoteVerification=!1,this.editNoteVerification=!1}ordernarIds(){return this.noteService.notesSignalComputed().sort((t,e)=>t.id-e.id)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=b({type:r,selectors:[["app-note-list"]],standalone:!0,features:[N],decls:22,vars:3,consts:[[3,"notaSeleccionada","deleteNote"],[1,"pt-36","w-full","min-h-[72rem]","relative","overflow-x-auto","shadow-md","sm:rounded-lg"],[1,"flex","flex-row","w-5/6","mx-auto","justify-end","mb-5"],[1,"px-5","py-2","bg-green-500","rounded-2xl","text-white",3,"click"],[1,"w-5/6","mx-auto","text-sm","text-left","rtl:text-right","text-gray-500","dark:text-gray-400"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],["scope","col",1,"px-6","py-3"],[3,"addVerificacion"],[3,"editVerificacion","notaSeleccionada","deleteNote"],[1,"bg-white","border-b","dark:bg-gray-800","dark:border-gray-700","hover:bg-gray-50","dark:hover:bg-gray-600"],["scope","row",1,"px-6","py-4","font-medium","text-gray-900","whitespace-nowrap","dark:text-white"],[1,"px-6","py-4"],[1,"flex","items-center","px-6","py-4"],[1,"font-medium","text-blue-600","dark:text-blue-500","hover:underline",3,"click"],["href","#",1,"font-medium","text-red-600","dark:text-red-500","hover:underline","ms-3",3,"click"],["scope","row","colspan","4",1,"text-center","px-6","py-4","font-medium","text-gray-900","whitespace-nowrap","dark:text-white"]],template:function(e,i){e&1&&(q(0,se,1,0,"app-add-note")(1,le,1,2,"app-edit-note",0),n(2,"div",1)(3,"div",2)(4,"button",3),d("click",function(){return i.addNote()}),a(5,"Insertar lista"),o()(),n(6,"table",4)(7,"thead",5)(8,"tr")(9,"th",6),a(10," ID "),o(),n(11,"th",6),a(12," Title "),o(),n(13,"th",6),a(14," Description "),o(),n(15,"th",6),a(16," Action "),o()()(),n(17,"tbody"),q(18,me,3,1)(19,ue,2,0),K(20,18,null,null,19),o()()()),e&2&&(O(i.addNoteVerification?0:-1),c(),O(i.editNoteVerification?1:-1),c(19),Q(i.noteService.loadingSignalComputed()))},dependencies:[_,v]})};var pe=[{path:"",component:R},{path:"add",component:_},{path:"edit/:id",component:v},{path:"**",redirectTo:""}],oe=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=H({type:r});static \u0275inj=z({imports:[P.forChild(pe),P]})};export{oe as NotesRoutingModule};
